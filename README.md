<!-- BANNER -->

<p align="center">
<img src="https://github.com/AbhigyanSr/File-Wizard/blob/a91ea70067dbe26cd8e436fa34d419e612efcb07/assets/banner.png" alt="Cloud File Converter Banner"/>
</p>

<h1 align="center">Cloud File Converter</h1>

<p align="center">
A cloud-native file conversion service built on AWS.<br />
This project uses a serverless and microservice architecture to convert .docx and .png files to .pdf format.
</p>

<p align="center">
<a href="#features"><strong>Features</strong></a> ·
<a href="#architecture-overview"><strong>Architecture</strong></a> ·
<a href="#deployment-guide"><strong>Deployment</strong></a>
</p>

<h3>Tech Stack<h3>
<p align="center">
<img src="https://img.shields.io/badge/html5-%23E34F26.svg?style=for-the-badge&logo=html5&logoColor=white" alt="HTML5"/>
<img src="https://img.shields.io/badge/javascript-%23323330.svg?style=for-the-badge&logo=javascript&logoColor=%23F7DF1E" alt="JavaScript"/>
<img src="https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54" alt="Python"/>
<img src="https://img.shields.io/badge/flask-%23000.svg?style=for-the-badge&logo=flask&logoColor=white" alt="Flask"/>
<img src="https://img.shields.io/badge/AWS-%23FF9900.svg?style=for-the-badge&logo=amazon-aws&logoColor=white" alt="AWS"/>
<img src="https://img.shields.io/badge/S3-569A31?style=for-the-badge&logo=amazon-s3&logoColor=white" alt="S3"/>
<img src="https://img.shields.io/badge/Lambda-FF9900?style=for-the-badge&logo=aws-lambda&logoColor=white" alt="Lambda"/>
<img src="https://img.shields.io/badge/API%20Gateway-FF4F8B?style=for-the-badge&logo=amazon-api-gateway&logoColor=white" alt="API Gateway"/>
<img src="https://img.shields.io/badge/EC2-FF9900?style=for-the-badge&logo=amazon-ec2&logoColor=white" alt="EC2"/>
</p>

<h2><b>Features</b></h2>
<b>Secure File Uploads:</b> Uses S3 Presigned URLs generated by a Lambda function for secure, direct-to-S3 uploads from the client-side.<br>
<b>Asynchronous Processing:</b> S3 event triggers initiate a decoupled backend process, providing a responsive user experience.<br>
<b>Microservice-based Conversion:</b> A Python Flask application running on an EC2 instance handles the core file conversion logic.<br>
<b>Scalable and Serverless:</b> Leverages AWS Lambda and API Gateway for the front-facing API, which can scale automatically with demand.

<h2><b>Architecture Overview</b></h2>
<p align="center">
<img alt="AWS Architecture" src="https://github.com/AbhigyanSr/File-Wizard/blob/a91ea70067dbe26cd8e436fa34d419e612efcb07/assets/architecture-fw.png">
</p>

<h3>The application workflow is as follows:</h3>

A static website is hosted on S3. When a user selects a file and clicks "Upload", the site makes a GET request to an API Gateway endpoint.
API Gateway triggers the getPresignedURL Lambda function.
This Lambda generates and returns a secure, temporary S3 presigned URL for uploading an object to the input-bucket.
The website uses this presigned URL to PUT the user's file directly and securely into the input-bucket.
The new object in the input-bucket triggers the triggerConverter Lambda function.
This Lambda sends a POST request to the Flask microservice running on an EC2 instance, passing the name of the new file.
The Flask app downloads the file from the input-bucket, converts it to PDF, and uploads the result to the output-bucket.

<h2>Deployment Guide</h2>
This section provides a high-level overview of the deployment steps. For detailed code, see the respective folders in this repository.

<h3>1. S3 Buckets</h3>
Create three unique S3 buckets:
<b>Website Bucket:</b> Configure for static website hosting and add a public-read bucket policy.
<b>Input Bucket:</b> Configure its CORS policy to allow PUT requests from your website's origin.
<b>Output Bucket:</b> No special configuration needed.

<h3>2. EC2 Flask Microservice</h3>
<b>Create a t2.micro EC2 instance</b> with an Ubuntu AMI.
Assign an IAM role to the instance with permissions to GetObject from the input bucket and PutObject to the output bucket.
Configure the instance's Security Group to allow inbound TCP traffic on your chosen port (e.g., 8000) and SSH (port 22).<br>
<br>
SSH into the instance and install dependencies:<br>
sudo apt update && sudo apt upgrade -y<br>
sudo apt install -y python3-pip pandoc<br>
pip3 install flask boto3 pypandoc docx2pdf<br>
<br>
Copy the application code from scripts/ and run it as a background process:<br>
nohup python3 docxconverter_app.py > docx.log 2>&1 &

[!NOTE]
The logs for the application will be saved to docx.log in the same directory.

<h3>3. Lambda Functions & API Gateway</h3>
<b>getPresignedURL Lambda:</b> Create a Lambda function with the code from lambda/getPresignedURL/. Set an environment variable for the input-bucket name.<br>

<b>triggerConverter Lambda:</b> Create a function with the code from lambda/triggerConverter/. Set an environment variable for the EC2 instance's public IP address. Configure an S3 trigger to invoke this function on object creation in the input-bucket.<br>

<b>API Gateway:</b> Create a REST API with a resource (e.g., /upload-url) and a GET method that integrates with the getPresignedURL Lambda. Enable CORS on this resource and deploy the API.

<h3>4. Frontend</h3>
Edit frontend/index.html and set the apiUrl variable to your deployed API Gateway's Invoke URL.
Upload index.html to your S3 website bucket.<br><br>

<h3>Authors</h3>
Abhigyan Srivastava <a href="https://github.com/AbhigyanSr">@AbhigyanSr</a>
